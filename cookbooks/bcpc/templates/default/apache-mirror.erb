################################################
#
#              Generated by Chef
#
################################################
<%
  if Dir.exists?("/home/ubuntu/chef-bcpc/bins/")
    bin_dir="/home/ubuntu/chef-bcpc/bins/"
  elsif Dir.exists?("/home/vagrant/chef-bcpc/bins/") 
    bin_dir="/home/vagrant/chef-bcpc/bins/"
  else
    bin_dir="/var/www"
  end
%>

<VirtualHost *:80>
        ServerAdmin webmaster@localhost

        DocumentRoot "<%= bin_dir %>"
        <Directory />
                Options FollowSymLinks
                AllowOverride None
        </Directory>
        <%= "<Directory \"#{bin_dir}\">" %>
                Options Indexes FollowSymLinks MultiViews
                AllowOverride None
                <IfModule mod_version.c> 
                    <IfVersion < 2.3>
                        Order allow,deny
                        allow from all
                    </IfVersion>
                    <IfVersion > 2.3>
                        Require all granted
                    </IfVersion>
                </IfModule>
                <IfModule !mod_version.c> 
                    Order allow,deny
                    allow from all
                </IfModule>
        </Directory>

        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
        <Directory "/usr/lib/cgi-bin">
                AllowOverride None
                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
                <IfModule mod_version.c> 
                    <IfVersion < 2.3>
                        Order allow,deny
                        allow from all
                    </IfVersion>
                    <IfVersion > 2.3>
                        Require all granted
                    </IfVersion>
                </IfModule>
                <IfModule !mod_version.c> 
                    Order allow,deny
                    allow from all
                </IfModule>
        </Directory>

        ErrorLog ${APACHE_LOG_DIR}/error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn

        CustomLog ${APACHE_LOG_DIR}/access.log combined

    <Directory /var/spool/apt-mirror/mirror/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        <IfModule mod_version.c> 
            <IfVersion < 2.3>
                Order allow,deny
                allow from all
            </IfVersion>
            <IfVersion > 2.3>
                Require all granted
            </IfVersion>
        </IfModule>
        <IfModule !mod_version.c> 
            Order allow,deny
            allow from all
        </IfModule>
    </Directory>
    Alias /ceph-dumpling /var/spool/apt-mirror/mirror/ceph.com/debian-dumpling
    Alias /ceph-extras /var/spool/apt-mirror/mirror/ceph.com/packages/ceph-extras/debian
    Alias /hwraid /var/spool/apt-mirror/mirror/hwraid.le-vert.net/ubuntu
    Alias /percona /var/spool/apt-mirror/mirror/repo.percona.com/apt
    Alias /ubuntu-cloud /var/spool/apt-mirror/mirror/ubuntu-cloud.archive.canonical.com/ubuntu
    Alias /rabbitmq /var/spool/apt-mirror/mirror/www.rabbitmq.com/debian
    Alias /ubuntu /var/spool/apt-mirror/mirror/us.archive.ubuntu.com/ubuntu
    Alias /canonical-support /var/spool/apt-mirror/mirror/ppa.launchpad.net/canonical-support/support-tools/ubuntu
    Alias /ceph-apache /var/spool/apt-mirror/mirror/gitbuilder.ceph.com/apache2-deb-precise-x86_64-basic/ref/master
    Alias /ceph-fcgi /var/spool/apt-mirror/mirror/gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master
    Alias /hdp /var/spool/apt-mirror/mirror/<%= hwx_uri = URI(node.default["bcpc"]["repos"]["hortonworks"]); hwx_uri.host + hwx_uri.path %>
    Alias /hdp-utils /var/spool/apt-mirror/mirror/<%= hdp_utils_uri = URI(node.default["bcpc"]["repos"]["hdp_utils"]); hdp_utils_uri.host + hdp_utils_uri.path %>
    Alias /cloudera /var/spool/apt-mirror/mirror/archive.cloudera.com/cdh5/ubuntu/precise/amd64/cdh
    Alias /cloudera-gpl /var/spool/apt-mirror/mirror/archive.cloudera.com/gplextras5/ubuntu/lucid/amd64/gplextras
</VirtualHost>
